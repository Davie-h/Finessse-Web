
            <html>
                
            <head>
                <title> Customer Transcript </title>
                
            <script src="https://cdn.botframework.com/botframework-webchat/4.15.7/webchat.js"></script>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/rxjs/7.8.0/rxjs.umd.min.js" integrity="sha512-v0/YVjBcbjLN6scjmmJN+h86koeB7JhY4/2YeyA5l+rTdtKLv0VbDBNJ32rxJpsaW1QGMd1Z16lsLOSGI38Rbg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            <script src="https://unpkg.com/react@18.2.0/umd/react.production.min.js"></script>
            <script src="https://unpkg.com/react-dom@18.2.0/umd/react-dom.production.min.js"></script>
            <script src="https://cdn.jsdelivr.net/npm/markdown-it@13.0.1/dist/markdown-it.min.js" integrity="sha256-hNyljag6giCsjv/yKmxK8/VeHzvMDvc5u8AzmRvm1BI=" crossorigin="anonymous"></script>
        
                <script>
                    function shareObservable(observable) {
                        let observers = [];
                        let subscription;

                        return new Observable(observer => {
                            if (!subscription) {
                                subscription = observable.subscribe({
                                    complete() {
                                        observers.forEach(observer => observer.complete());
                                    },
                                    error(err) {
                                        observers.forEach(observer => observer.error(err));
                                    },
                                    next(value) {
                                        observers.forEach(observer => observer.next(value));
                                    }
                                });
                            }

                            observers.push(observer);

                            return () => {
                                observers = observers.filter(o => o !== observer);

                                if (!observers.length) {
                                    subscription.unsubscribe();
                                    subscription = null;
                                }
                            };
                        });
                    }
                </script>
                <script>
                    const messages = [{"created":"2023-10-07T22:02:32+00:00","isControlMessage":true,"content":"<deletemember><eventtime>1696716152462</eventtime></deletemember>","createdDateTime":"2023-10-07T22:02:32+00:00","deleted":false,"id":"1696716152462"},{"created":"2023-10-07T22:02:32+00:00","isControlMessage":false,"content":"Logan has ended the conversation. If this was unexpected, a support engineer will reach out to you via email or phone shortly.","contentType":"text","createdDateTime":"2023-10-07T22:02:32+00:00","deleted":false,"from":{"user":{"displayName":"","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_00000011-96b1-f18c-3dfe-9c3a0d007284"}},"attachments":[],"id":"1696716152054","tags":"system,agentendconversation","fromUserId":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"},{"created":"2023-10-07T22:02:27+00:00","isControlMessage":false,"content":"I need to close the chat, thanks for understandings!","contentType":"text","createdDateTime":"2023-10-07T22:02:27+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696716147950","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T22:00:30+00:00","isControlMessage":false,"content":"the captcha got me stuck on that error please understand sir","contentType":"text","createdDateTime":"2023-10-07T22:00:30+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696716030494","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"2nlcqd72yub","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:59:43+00:00","isControlMessage":false,"content":"Your noCAPTCHA user response code is missing or invalid","contentType":"text","createdDateTime":"2023-10-07T21:59:43+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696715983252","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"x54tsmuz4z","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:57:33+00:00","isControlMessage":false,"content":"ok","contentType":"text","createdDateTime":"2023-10-07T21:57:33+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696715853154","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T21:57:22+00:00","isControlMessage":false,"content":"please wait","contentType":"text","createdDateTime":"2023-10-07T21:57:22+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696715842688","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"uhnkbardvga","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:57:07+00:00","isControlMessage":false,"content":"their captcha is having issues","contentType":"text","createdDateTime":"2023-10-07T21:57:07+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696715827036","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"iete6zh1op","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:56:29+00:00","isControlMessage":false,"content":"It looks like I will need some more time to review this matter, and unfortunately will not be able to resolve the issue during this chat.  \nI will end the chat now. I will complete the review and you will shortly receive an email regarding the status of your account.","contentType":"text","createdDateTime":"2023-10-07T21:56:29+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696715789958","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T21:53:28+00:00","isControlMessage":false,"content":"sending","contentType":"text","createdDateTime":"2023-10-07T21:53:28+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696715608740","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"ey3bgt31daa","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:52:56+00:00","isControlMessage":false,"content":"the url please","contentType":"text","createdDateTime":"2023-10-07T21:52:56+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696715576454","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T21:52:40+00:00","isControlMessage":false,"content":"my linkedIn email is githukudavid120@gmail.com","contentType":"text","createdDateTime":"2023-10-07T21:52:40+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696715560387","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"0h7d8dujmc5a","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:50:59+00:00","isControlMessage":false,"content":"and your LinkedIn profile?","contentType":"text","createdDateTime":"2023-10-07T21:50:59+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696715459343","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T21:50:52+00:00","isControlMessage":false,"content":"ok, could you please confirm your billing address?","contentType":"text","createdDateTime":"2023-10-07T21:50:52+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696715452020","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T21:50:29+00:00","isControlMessage":false,"content":"my student email is eb8.4443.20@student.chuka.ac.ke","contentType":"text","createdDateTime":"2023-10-07T21:50:29+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696715429006","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"dwz4pszoms7","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:49:50+00:00","isControlMessage":false,"content":"I applied through github student email  and I got student developer pack which includes azure","contentType":"text","createdDateTime":"2023-10-07T21:49:50+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696715390536","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"3qbfnqibuyy","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:47:33+00:00","isControlMessage":false,"content":"I’ll need to collect a little bit of additional information before we proceed to the next steps. Could you please confirm your LinkedIn profile and your billing address?","contentType":"text","createdDateTime":"2023-10-07T21:47:33+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696715253189","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T21:43:57+00:00","isControlMessage":false,"content":"okay then","contentType":"text","createdDateTime":"2023-10-07T21:43:57+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696715037978","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"5f9fefazs7c","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:43:24+00:00","isControlMessage":false,"content":"I will check your account right away, this might take a few moments, please bear with me.","contentType":"text","createdDateTime":"2023-10-07T21:43:24+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696715004746","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T21:42:51+00:00","isControlMessage":false,"content":"I strongly believe that my account was disabled by mistake","contentType":"text","createdDateTime":"2023-10-07T21:42:51+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696714971071","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"01nkvdggcxva","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:42:19+00:00","isControlMessage":false,"content":"Hello David, thank you for reaching out. My name is Logan and I will happily assist you on this chat.","contentType":"text","createdDateTime":"2023-10-07T21:42:19+00:00","deleted":false,"from":{"user":{"displayName":"Logan","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000000f-6d97-5b88-defd-8b3a0d00d36b"}},"attachments":[],"id":"1696714939420","tags":"public","deliveryMode":"bridged"},{"created":"2023-10-07T21:41:44+00:00","isControlMessage":false,"content":"hello","contentType":"text","createdDateTime":"2023-10-07T21:41:44+00:00","deleted":false,"from":{"application":{"displayName":"Customer","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"}},"attachments":[],"id":"1696714904370","deliveryMode":"bridged","widgetId":"8c609396-fd80-466f-9a1e-5fbdb47929ac","clientActivityId":"j7b8gnuomd","tags":"ChannelId-lcw,FromCustomer"},{"created":"2023-10-07T21:41:29+00:00","isControlMessage":false,"content":"Logan has joined the conversation.","contentType":"text","createdDateTime":"2023-10-07T21:41:29+00:00","deleted":false,"from":{"user":{"displayName":"","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_00000011-96b1-f18c-3dfe-9c3a0d007284"}},"attachments":[],"id":"1696714889362","tags":"system,agentaccepted","fromUserId":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"},{"created":"2023-10-07T21:41:06+00:00","isControlMessage":false,"content":"A support engineer will be with you in a moment. In the unlikely event that an engineer is not connected with you, be assured your support case has been created and a support engineer will reach out to you via email or phone.","contentType":"text","createdDateTime":"2023-10-07T21:41:06+00:00","deleted":false,"from":{"user":{"displayName":"","id":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_00000011-96b1-f18c-3dfe-9c3a0d007284"}},"attachments":[],"id":"1696714866842","tags":"system,agentassignmentready","fromUserId":"8:acs:4c16003e-75ab-4747-b30c-557edd84758e_0000001b-abc4-d305-92fd-8b3a0d00bd6d"},{"created":"2023-10-07T20:45:20+00:00","isControlMessage":true,"content":"<historydisclosedupdate><eventtime>1696711520497</eventtime></historydisclosedupdate>","createdDateTime":"2023-10-07T20:45:20+00:00","deleted":false,"id":"1696711520497"},{"created":"2023-10-07T20:45:20+00:00","isControlMessage":true,"content":"<addmember><eventtime>1696711520443</eventtime></addmember>","createdDateTime":"2023-10-07T20:45:20+00:00","deleted":false,"id":"1696711520443"}];
                    const disableMarkdownMessageFormatting = true;
                    const disableNewLineMarkdownSupport = false;
                </script>
                <script>
                    class Translator {
                        static convertTranscriptMessageToActivity(message) {
                            const {created, isControlMessage, content, tags, from, attachments, amsMetadata, amsReferences} = message;
                            const activity = {
                                from: {
                                    role: 'bot'
                                },
                                type: 'message'
                            };

                            // Ignore control messages
                            if (isControlMessage) {
                                return false;
                            }

                            if (tags) {
                                const formattedTags = tags.split(',');

                                // Ignore system message
                                if (formattedTags.includes('system')) {
                                    return false;
                                }

                                // Ignore hidden message
                                if (formattedTags.includes('Hidden')) {
                                    return false;
                                }
                            }

                            // Add C1 user display name
                            if (from && from.user && from.user.displayName) {
                                activity.from.name = from.user.displayName;
                            }

                            // Add C2 user display name
                            if (from && from.application && from.application.displayName && from.application.displayName === 'Customer') {
                                activity.from = {
                                    role: 'user',
                                    name: from.application.displayName
                                };
                            }

                            // Attachments
                            if (amsReferences && amsMetadata) {
                                const metadata = JSON.parse(amsMetadata);
                                const { fileName } = metadata[0];
                                const text = `The following attachment was uploaded during the conversation: ${fileName}`;

                                if (message.attachments && message.attachments.length > 0 && message.contentUrl) {
                                    activity.attachments = message.attachments;
                                    activity.attachments[0].contentUrl = message.contentUrl;
                                    activity.attachments[0].thumbnailUrl =  message.contentUrl;
                                };

                                return {
                                    ...activity,
                                    text,
                                    timestamp: created
                                }
                            }

                            // Message
                            if (content) {
                                // Adaptive card formatting
                                if (content.includes('"text"') && content.includes('"attachments"') && content.includes('"suggestedActions"')) {
                                    try {
                                        const partialActivity = JSON.parse(content);
                                        return {
                                            ...activity,
                                            ...partialActivity,
                                            timestamp: created
                                        };
                                    } catch {

                                    }
                                }
                            }

                            return {
                                ...activity,
                                text: content,
                                timestamp: created
                            };
                        }
                    }
                </script>
                <script>
                    class TranscriptAdapter {
                        constructor() {
                            this.connectionStatus$ = new window.rxjs.BehaviorSubject(0); // Uninitialized
                            this.activity$ = shareObservable(new Observable((observer) => {
                                this.activityObserver = observer;

                                this.connectionStatus$.next(1); // Connecting
                                this.connectionStatus$.next(2); // Online

                                // Retrieve messages
                                if (messages) {
                                    setTimeout(() => { // setTimeout is needed due to some WebChat issues
                                        messages.map((message) => {
                                            this.activityObserver.next({
                                                ...Translator.convertTranscriptMessageToActivity(message),
                                                type: 'message'
                                            });
                                        });
                                    }, 1);
                                }
                            }));
                        }
                    }
                </script>
                <style>
                    body {
                        margin: 0;
                    }

                    .message-name {
                        font-family: Segoe UI,SegoeUI,Helvetica Neue,Helvetica,Arial,sans-serif;
                        font-weight: 700;
                        font-size: 10px;
                    }

                    .message-timestamp {
                        font-family: Segoe UI,SegoeUI,Helvetica Neue,Helvetica,Arial,sans-serif;
                        font-weight: 500;
                        font-size: 10px;
                    }

                    .avatar {
                        width: 40px;
                        height: 40px;
                        border-radius: 50%;
                        text-align: center;
                    }

                    .avatar--bot {
                        background-color: #F3F2F1;
                    }

                    .avatar--user {
                        background-color: #EFF6FC;
                    }

                    .avatar > p {
                        font-weight: 600;
                        text-align: center;
                        line-height: 0.5;
                        font-family: "Segoe UI", Arial, sans-serif;
                    }

                    .avatar--bot > p {
                        color: #323130;
                    }

                    .avatar--user > p {
                        color: #323130;
                    }

                    .webchat__bubble__content>div.ms_lcw_webchat_adaptive_card {
                        background-color: #FFF;
                    }

                    div[class="ac-textBlock"] {
                        color: #000 !important;
                    }

                    .ms_lcw_webchat_received_message a:link, .ms_lcw_webchat_received_message a:visited, .ms_lcw_webchat_received_message a:hover, .ms_lcw_webchat_received_message a:active {
                        color: #FFF;
                    }
                </style>
            </head>
        
                
            <body>
                <script>
                    if (!navigator.onLine) {
                        const offlineText = `Network Error. Please make sure you are connected to the internet.`;
                        document.body.innerHTML = offlineText;
                    }

                    window.addEventListener("online", () => {
                        document.body.innerHTML = `Connection restored. Please refresh the page <button onclick="window.location.reload()"> Refresh </button>`;
                    });
                </script>
                <div id="transcript"></div>
                <script>
                    const getIconText = (text) => {
                        if (text) {
                            const initials = text.split(/\s/).reduce((response, word) => response += word.slice(0, 1), '');
                            if (initials.length > 1) {
                                return initials.substring(0, 2).toUpperCase();
                            } else {
                                return text.substring(0, 2).toUpperCase();
                            }
                        }

                        return "";
                    }

                    const activityMiddleware = () => (next) => (...args) => {
                        const [card] = args;

                        if (card.activity) {
                            if (card.activity.from && card.activity.from.role === "channel") {
                                return () => false;
                            }

                            // Incoming text message
                            if (card.activity.text && card.activity.from && card.activity.from.role !== "user") {
                                return (...renderArgs) => (React.createElement(
                                    'div',
                                    {className: 'ms_lcw_webchat_received_message'},
                                    next(...args)(...renderArgs)
                                ))
                            }
                        }

                        return next(...args);
                    };

                    const activityStatusMiddleware = () => (next) => (...args) => {
                        const [card] = args;
                        const {activity} = card;

                        if (activity) {
                            const {from, timestamp} = activity;

                            const nameElement = React.createElement(
                                'span',
                                {className: 'message-name'},
                                from.name
                            );

                            const formattedDate = new Date(timestamp);
                            const formattedTimeString = formattedDate.toLocaleTimeString("en-us", { year: "numeric", month:"numeric", day:"numeric", hour: "2-digit", minute: "2-digit"});

                            const timestampElement = React.createElement(
                                'span',
                                {className: 'message-timestamp'},
                                formattedTimeString
                            );

                            return from.name && timestamp && React.createElement('span', null, nameElement, ' - ', timestampElement)
                        }

                        return next(...args);
                    };

                    const avatarMiddleware = () => (next) => (...args) => {
                        const [card] = args;
                        const {fromUser, activity} = card;
                        const initials = getIconText(activity.from.name);

                        const avatarElement = React.createElement(
                            "div",
                            {className: fromUser? "avatar avatar--user": "avatar avatar--bot"},
                            React.createElement(
                                "p",
                                null,
                                `${initials}`
                            )
                        );

                        return avatarElement;
                    }

                    const attachmentMiddleware = () => (next) => (...args) => {
                        const [card] = args;
                        const {activity} = card;

                        if (activity) {
                            const { activity: { attachments }, attachment } = card;

                            // No attachment
                            if (!attachments || !attachments.length || !attachment) {
                                return next(...args);
                            }

                            let { content, contentType } = attachment || { content: "", contentType: "" };

                            // Adaptive card
                            if (contentType.startsWith("application/vnd.microsoft.card")) {
                                const adaptiveCardElement = React.createElement(
                                    "div",
                                    {className: 'ms_lcw_webchat_adaptive_card'},
                                    next(...args)
                                );

                                return adaptiveCardElement;
                            }
                        }

                        return next(...args);
                    }

                    const createMarkdown = (disableMarkdownMessageFormatting, disableNewLineMarkdownSupport) => {
                        let markdown;
                        if (!disableMarkdownMessageFormatting) {
                            markdown = new window.markdownit(
                                "default",
                                {
                                    html: true,
                                    linkify: true,
                                    breaks: (!disableNewLineMarkdownSupport)
                                }
                            );
                        } else {
                            markdown = new window.markdownit(
                                "zero",
                                {
                                    html: true,
                                    linkify: true,
                                    breaks: (!disableNewLineMarkdownSupport)
                                }
                            );

                            markdown.enable([
                                "entity",
                                "linkify",
                                "html_block",
                                "html_inline",
                                "newline"
                            ]);
                        }

                        return markdown;
                    };

                    const markdown = createMarkdown(disableMarkdownMessageFormatting, disableNewLineMarkdownSupport);
                    const renderMarkdown = (text) => {
                        const render = disableNewLineMarkdownSupport? markdown.renderInline.bind(markdown): markdown.render.bind(markdown);
                        text = render(text);
                        return text;
                    };

                    const adapter = new TranscriptAdapter();
                    const styleOptions = {
                        hideSendBox: true,
                        backgroundColor: '#FFFFFF',
                        bubbleBackground: '#F3F2F1',
                        bubbleTextColor: '#323130',
                        bubbleBorderRadius: 12,
                        bubbleNubSize: 1,
                        bubbleFromUserBackground: '#EFF6FC',
                        bubbleFromUserTextColor: '#323130',
                        bubbleFromUserBorderRadius: 12,
                        bubbleFromUserNubSize: 1,
                        botAvatarInitials: 'C1',
                        userAvatarInitials: 'C2'
                    };

                    window.WebChat.renderWebChat({
                        directLine: adapter,
                        styleOptions,
                        activityMiddleware,
                        activityStatusMiddleware,
                        avatarMiddleware,
                        attachmentMiddleware,
                        renderMarkdown
                    },
                    document.getElementById('transcript'));
                </script>
            </body>
        
            </html>
        